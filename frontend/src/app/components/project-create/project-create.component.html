<div class="project-create-container">
  <header class="page-header">
    <h1>Crear Nuevo Proyecto OpenUP</h1>
  </header>

  <div class="card">
    <form (ngSubmit)="onSubmit()" #projectForm="ngForm">
      @if (error) {
        <div class="error-message">
          {{ error }}
        </div>
      }

      <div class="form-section">
        <h3>Informaci√≥n B√°sica</h3>

        <div class="form-group">
          <label for="name">
            Nombre del Proyecto <span class="required">*</span>
          </label>
          <input
            type="text"
            id="name"
            name="name"
            [(ngModel)]="formData.name"
            required
            maxlength="200"
            placeholder="Ej: Sistema de Gesti√≥n de Proyectos"
            [disabled]="loading"
            />
          </div>

          <div class="form-group">
            <label for="code">
              C√≥digo del Proyecto <span class="required">*</span>
            </label>
            <input
              type="text"
              id="code"
              name="code"
              [(ngModel)]="formData.code"
              required
              maxlength="50"
              placeholder="Ej: PROJ-2025-001"
              [disabled]="loading"
              />
              <small class="form-hint">Debe ser √∫nico en el sistema</small>
            </div>

            <div class="form-group">
              <label for="startDate">
                Fecha de Inicio <span class="required">*</span>
              </label>
              <input
                type="date"
                id="startDate"
                name="startDate"
                [(ngModel)]="formData.startDate"
                required
                [disabled]="loading"
                />
              </div>
            </div>

            <div class="form-section">
              <h3>Informaci√≥n Adicional</h3>

              <div class="form-group">
                <label for="responsiblePerson">Responsable del Proyecto</label>
                <input
                  type="text"
                  id="responsiblePerson"
                  name="responsiblePerson"
                  [(ngModel)]="formData.responsiblePerson"
                  maxlength="200"
                  placeholder="Nombre del coordinador o responsable"
                  [disabled]="loading"
                  />
                </div>

                <div class="form-group">
                  <label for="description">Descripci√≥n</label>
                  <textarea
                    id="description"
                    name="description"
                    [(ngModel)]="formData.description"
                    rows="4"
                    maxlength="1000"
                    placeholder="Describe el objetivo y alcance del proyecto..."
                    [disabled]="loading"
                  ></textarea>
                </div>

                <div class="form-group">
                  <label for="tags">Etiquetas</label>
                  <input
                    type="text"
                    id="tags"
                    name="tags"
                    [(ngModel)]="formData.tags"
                    maxlength="500"
                    placeholder="Ej: backend, frontend, web, mobile"
                    [disabled]="loading"
                    />
                    <small class="form-hint">Separa las etiquetas con comas</small>
                  </div>
                </div>

                <div class="form-section">
                  <h3>Plan del Proyecto</h3>

                  <div class="form-group">
                    <label for="objetivos">Objetivos</label>
                    <textarea
                      id="objetivos"
                      name="objetivos"
                      [(ngModel)]="formData.objetivos"
                      rows="3"
                      maxlength="2000"
                      placeholder="Objetivos del proyecto"
                      [disabled]="loading"
                    ></textarea>
                  </div>

                  <div class="form-group">
                    <label for="alcance">Alcance</label>
                    <textarea
                      id="alcance"
                      name="alcance"
                      [(ngModel)]="formData.alcance"
                      rows="3"
                      maxlength="2000"
                      placeholder="Alcance del proyecto"
                      [disabled]="loading"
                    ></textarea>
                  </div>

                  <div class="form-group">
                    <label>üìÖ Cronograma Inicial</label>
                    <div class="cronograma-list">
                      @for (item of cronogramaItems; track $index; let i = $index) {
                        <div class="cronograma-item">
                          <div class="cronograma-inputs">
                            <input type="date" [name]="'cronogramaDate_' + i" [(ngModel)]="cronogramaItems[i].date" [disabled]="loading" class="form-control" />
                            <textarea rows="2" [name]="'cronogramaDesc_' + i" [(ngModel)]="cronogramaItems[i].description" placeholder="Descripci√≥n del evento o hito..." [disabled]="loading" class="form-control"></textarea>
                          </div>
                          <button type="button" class="btn btn-sm btn-danger" (click)="removeCronogramaItem(i)" [disabled]="loading">üóëÔ∏è</button>
                        </div>
                      }
                      <button type="button" class="btn btn-secondary btn-add" (click)="addCronogramaItem()" [disabled]="loading">‚ûï Agregar fecha clave</button>
                      <small class="form-hint">üí° Agrega fechas importantes del proyecto con su descripci√≥n</small>
                    </div>
                  </div>

                  <div class="form-group">
                    <label>üë• Responsables</label>
                    <div class="responsables-list">
                      @for (r of responsablesList; track $index; let i = $index) {
                        <div class="responsable-item">
                          <input type="text" [name]="'responsable_' + i" [(ngModel)]="responsablesList[i]" placeholder="Ej: Juan P√©rez - L√≠der T√©cnico" [disabled]="loading" class="form-control" />
                          <button type="button" class="btn btn-sm btn-danger" (click)="removeResponsable(i)" [disabled]="loading">üóëÔ∏è</button>
                        </div>
                      }
                      <button type="button" class="btn btn-secondary btn-add" (click)="addResponsable()" [disabled]="loading">‚ûï Agregar responsable</button>
                      <small class="form-hint">üí° Incluye nombre completo y rol en el proyecto</small>
                    </div>
                  </div>

                  <div class="form-group">
                    <label>üéØ Hitos del Proyecto</label>
                    <div class="hitos-list">
                      @for (h of hitosList; track $index; let i = $index) {
                        <div class="hito-item">
                          <span class="hito-number">{{ i + 1 }}</span>
                          <input type="text" [name]="'hito_' + i" [(ngModel)]="hitosList[i]" placeholder="Ej: Lanzamiento versi√≥n beta" [disabled]="loading" class="form-control" />
                          <div class="hito-actions">
                            <button type="button" class="btn btn-sm btn-icon" (click)="moveHitoUp(i)" [disabled]="loading || i === 0" title="Subir">‚¨ÜÔ∏è</button>
                            <button type="button" class="btn btn-sm btn-icon" (click)="moveHitoDown(i)" [disabled]="loading || i === hitosList.length - 1" title="Bajar">‚¨áÔ∏è</button>
                            <button type="button" class="btn btn-sm btn-danger" (click)="removeHito(i)" [disabled]="loading">üóëÔ∏è</button>
                          </div>
                        </div>
                      }
                      <button type="button" class="btn btn-secondary btn-add" (click)="addHito()" [disabled]="loading">‚ûï Agregar hito</button>
                      <small class="form-hint">üí° Define los hitos principales y ord√©nalos con las flechas</small>
                    </div>
                  </div>
                </div>

                <div class="info-box">
                  <strong>‚ÑπÔ∏è Nota:</strong> Al crear el proyecto, se generar√°n autom√°ticamente las cuatro fases de OpenUP:
                  <ul>
                    <li>Incepci√≥n</li>
                    <li>Elaboraci√≥n</li>
                    <li>Construcci√≥n</li>
                    <li>Transici√≥n</li>
                  </ul>
                </div>

                <div class="form-actions">
                  <button
                    type="button"
                    class="btn btn-secondary"
                    (click)="onCancel()"
                    [disabled]="loading"
                    >
                    Cancelar
                  </button>
                  <button
                    type="submit"
                    class="btn btn-primary"
                    [disabled]="loading || !projectForm.form.valid"
                    >
                    {{ loading ? 'Creando...' : 'Crear Proyecto' }}
                  </button>
                </div>
              </form>
            </div>
          </div>
