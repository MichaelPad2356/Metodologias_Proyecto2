<div class="progress-dashboard">
  <h3>Progreso del Proyecto</h3>

  @if (loading) {
    <div class="loading">Cargando progreso...</div>
  }
  
  @if (error) {
    <div class="error-message">{{ error }}</div>
  }

  @if (progress && !loading) {
    <div class="progress-content">
      <!-- Progreso Total -->
      <div class="total-progress">
        <div class="progress-header">
          <h4>Progreso Total</h4>
          <span class="percentage">{{ progress.progresoTotal.toFixed(0) }}%</span>
        </div>
        <div class="progress-bar-container">
          <div class="progress-bar" 
               [class]="getProgressBarClass(progress.progresoTotal)"
               [style.width]="getProgressWidth(progress.progresoTotal)">
          </div>
        </div>
        <p class="task-count">
          {{ progress.tareasCompletadas }} de {{ progress.totalTareas }} tareas completadas
        </p>
      </div>

      <!-- Progreso por Fase -->
      <div class="phase-progress-section">
        <h4>Progreso por Fase</h4>
        
        @if (progress.progresosPorFase.length === 0) {
          <div class="no-phases">
            No hay fases con tareas asignadas
          </div>
        }

        @for (fase of progress.progresosPorFase; track fase.fase) {
          <div class="phase-item">
            <div class="phase-header">
              <span class="phase-name">{{ fase.fase }}</span>
              <span class="percentage">{{ fase.porcentaje.toFixed(0) }}%</span>
            </div>
            <div class="progress-bar-container">
              <div class="progress-bar" 
                   [class]="getProgressBarClass(fase.porcentaje)"
                   [style.width]="getProgressWidth(fase.porcentaje)">
              </div>
            </div>
            <p class="task-count">
              {{ fase.completadas }} de {{ fase.total }} tareas completadas
            </p>
          </div>
        }
      </div>
    </div>
  }
</div>
